(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[66],{D8Xz:function(a,e,t){"use strict";t.r(e),t.d(e,"default",function(){return K});t("IzEo");var n,r,l,i,s=t("bx4M"),o=(t("T2oS"),t("W9HT")),c=(t("+L6B"),t("2/Rp")),p=(t("iQDF"),t("+eQT")),d=(t("14J3"),t("BMrR")),m=(t("6UJt"),t("DFOY")),u=(t("jCWc"),t("kPKH")),h=t("jehZ"),g=t.n(h),y=(t("5Dmo"),t("3S7+")),f=t("p0pE"),E=t.n(f),v=t("eHn4"),C=t.n(v),_=t("2Taf"),D=t.n(_),Y=t("vZ4D"),I=t.n(Y),b=t("l4Ni"),T=t.n(b),w=t("ujKo"),O=t.n(w),M=t("MhPg"),k=t.n(M),V=(t("y8nQ"),t("Vl3Y")),S=(t("OaEy"),t("2fM7")),F=t("q1tI"),P=t.n(F),j=t("OT3T"),R=t.n(j),J=t("MuoO"),L=t("Qyje"),N=t("wd/R"),Q=t.n(N),q=t("KTCi"),x=S["a"].Option,A={labelCol:{span:4},wrapperCol:{span:18}},H=V["a"].Item,K=(n=V["a"].create(),r=Object(J["connect"])(function(a){var e=a.statistics,t=a.loading;return{statistics:e,loading:t.models.statistics}}),n(l=r((i=function(a){function e(){var a,t;D()(this,e);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return t=T()(this,(a=O()(e)).call.apply(a,[this].concat(r))),t.state={startValue:null,endValue:null},t.disabledStartDate=function(a){var e=t.state.endValue;return!(!a||!e)&&a.valueOf()>e.valueOf()},t.disabledEndDate=function(a){var e=t.state.startValue;return!(!a||!e)&&a.valueOf()<=e.valueOf()},t.onChange=function(a,e){t.setState(C()({},a,e))},t.onStartChange=function(a){t.onChange("startValue",a)},t.onEndChange=function(a){t.onChange("endValue",a)},t.categoryChange=function(a,e,n){var r=t.props,l=r.dispatch,i=r.form.setFieldsValue,s=r.statistics,o=s.enter_areaOption,c=s.enter_groupOption,p=s.enter_data_params;l({type:"statistics/fetch_category_item",payload:{id:a},params:{type:e,stage:n},callback:function(a){l({type:"statistics/changeAreaOption",payload:E()({},o,C()({},"line".concat(e),a.area.map(function(a){return{value:a.id,label:a.name,isLeaf:!1}}))),params:{type:1}}),l({type:"statistics/changeGroupOption",payload:E()({},c,C()({},"line".concat(e),a.group)),params:{type:1}}),i(C()({},"params[".concat(e-1,"][areaId]"),void 0)),i(C()({},"params[".concat(e-1,"][group]"),void 0)),i(C()({},"params[".concat(e-1,"][schoolId]"),void 0))}}),l({type:"statistics/changeDataParams",payload:E()({},p,C()({},"line".concat(e),E()({},p["line".concat(e)],{categoryId:a}))),params:{type:1}})},t.loadCascaderData=function(a,e){var n=t.props,r=n.dispatch,l=n.statistics.enter_areaOption,i=a[a.length-1];i.loading=!0,r({type:"global/fetch_area",payload:{id:i.value},callback:function(a){i.loading=!1,i.children=a.map(function(a){return{label:a.title,value:a.key,isLeaf:a.isLeaf}}),r({type:"statistics/changeAreaOption",payload:E()({},l),params:{type:1}})}})},t.cascaderChange=function(a,e){var n=t.props,r=n.dispatch,l=n.form.setFieldsValue,i=n.statistics.enter_data_params;r({type:"statistics/changeDataParams",payload:E()({},i,C()({},"line".concat(e),E()({},i["line".concat(e)],{areaId:a}))),params:{type:1}}),l(C()({},"params[".concat(e-1,"][schoolId]"),void 0)),l(C()({},"params[".concat(e-1,"][group]"),void 0))},t.groupChange=function(a,e){var n=t.props,r=n.dispatch,l=n.form,i=l.setFieldsValue,s=l.getFieldValue,o=n.statistics,c=o.enter_schoolOption,p=o.enter_data_params,d=s("params[".concat(e-1,"][areaId]"));d=d[d.length-1],r({type:"statistics/fetch_school_list",payload:{areaId:d,start:0,count:1e5,group:a},callback:function(a){r({type:"statistics/changeSchoolOption",payload:E()({},c,C()({},"line".concat(e),a)),params:{type:1}}),i(C()({},"params[".concat(e-1,"][schoolId]"),void 0))}}),r({type:"statistics/changeDataParams",payload:E()({},p,C()({},"line".concat(e),E()({},p["line".concat(e)],{group:a}))),params:{type:1}})},t.schoolChange=function(a,e){var n=t.props,r=n.dispatch,l=n.statistics.enter_data_params;r({type:"statistics/changeDataParams",payload:E()({},l,C()({},"line".concat(e),E()({},l["line".concat(e)],{schoolId:a}))),params:{type:1}})},t.genderChange=function(a,e){var n=t.props,r=n.dispatch,l=n.statistics.enter_data_params;r({type:"statistics/changeDataParams",payload:E()({},l,C()({},"line".concat(e),E()({},l["line".concat(e)],{gender:a}))),params:{type:1}})},t.handleSubmit=function(){var a=t.props,e=a.dispatch,n=a.form.validateFields,r=a.statistics.enter_data_params,l=r.line1,i=r.line2;n(function(a,t){a||(e({type:"statistics/fetch_enter_data",payload:E()({},l,{startTime:Q()(t.startTime).format("YYYY/MM/DD"),endTime:Q()(t.endTime).format("YYYY/MM/DD")}),params:{type:1}}),e({type:"statistics/fetch_enter_data",payload:E()({},i,{startTime:Q()(t.startTime).format("YYYY/MM/DD"),endTime:Q()(t.endTime).format("YYYY/MM/DD")}),params:{type:2}}))})},t.handleReset=function(){var a=t.props,e=a.dispatch,n=a.form.resetFields;n(),e({type:"statistics/fetch_enter_data",payload:{startTime:Q()().subtract(7,"days").format("YYYY/MM/DD"),endTime:Q()().format("YYYY/MM/DD")},params:{type:1}}),e({type:"statistics/fetch_enter_data",payload:{startTime:Q()().subtract(7,"days").format("YYYY/MM/DD"),endTime:Q()().format("YYYY/MM/DD")},params:{type:2}})},t}return k()(e,a),I()(e,[{key:"componentDidMount",value:function(){var a=this.props,e=a.dispatch,t=a.statistics.enter_data_params,n=t.line1,r=t.line2;e({type:"statistics/fetch_category_list",payload:{start:0,count:1e4}}),e({type:"statistics/fetch_enter_data",payload:E()({},n),params:{type:1}}),e({type:"statistics/fetch_enter_data",payload:E()({},r),params:{type:2}})}},{key:"render",value:function(){var a=this,e=this.props,t=e.statistics,n=t.enter_data,r=n.line1,l=n.line2,i=t.enter_data_params,h=i.line1,f=i.line2,E=t.category_list,v=t.enter_category_item,C=(v.line1,v.line2,t.enter_areaOption),_=t.enter_groupOption,D=t.enter_schoolOption,Y=e.loading,I=e.form.getFieldDecorator,b=r.data.map(function(a,e){return{x:a.createTime,y1:a.count,y2:l.data[e]&&l.data[e].count||0}}),T={startTime:h.startTime,endTime:h.endTime,categoryId1:h.categoryId,areaId1:h.areaId&&h.areaId[h.areaId.length-1],group1:h.group,schoolId1:h.schoolId,gender1:h.gender,categoryId2:f.categoryId,areaId2:f.areaId&&f.areaId[f.areaId.length-1],group2:f.group,schoolId2:f.schoolId,gender2:f.gender};for(var w in T){var O=T[w];O||delete T[w]}return P.a.createElement(s["a"],{bordered:!1},P.a.createElement(o["a"],{spinning:Y},P.a.createElement("div",null,P.a.createElement("span",{className:R.a.total},P.a.createElement("p",{className:R.a.total_title},"\u622a\u6b62\u5f53\u524d\u603b\u91cf"),P.a.createElement("div",{className:R.a.total_num},r.totalCount))),P.a.createElement(d["a"],{gutter:12,style:{marginTop:48}},P.a.createElement(u["a"],{span:6},P.a.createElement(H,g()({},A,{label:"\u8d5b\u9879"}),I("params[0][categoryId]",{initialValue:h.categoryId})(P.a.createElement(S["a"],{onChange:function(e){return a.categoryChange(e,1,1)},style:{width:"100%"}},E.map(function(a){return P.a.createElement(S["a"].Option,{key:a.id,value:a.id},P.a.createElement(y["a"],{title:a.name},a.name))}))))),P.a.createElement(u["a"],{span:6},P.a.createElement(H,g()({},A,{label:"\u533a\u57df"}),I("params[0][areaId]",{initialValue:h.areaId})(P.a.createElement(m["a"],{allowClear:!1,placeholder:"",onChange:function(e){return a.cascaderChange(e,1)},loadData:function(e){return a.loadCascaderData(e,1)},options:C.line1,style:{width:"100%"}})))),P.a.createElement(u["a"],{span:3},P.a.createElement(H,{labelCol:{span:7},wrapperCol:{span:17},label:"\u7ec4\u522b"},I("params[0][group]",{initialValue:h.group})(P.a.createElement(S["a"],{onChange:function(e){return a.groupChange(e,1)},style:{width:"100%"}},_.line1.map(function(a){return 1===a?P.a.createElement(x,{key:a,value:a},"\u5c0f\u5b66"):2===a?P.a.createElement(x,{key:a,value:a},"\u521d\u4e2d"):3===a?P.a.createElement(x,{key:a,value:a},"\u9ad8\u4e2d"):4===a?P.a.createElement(x,{key:a,value:a},"\u4e2d\u5b66"):void 0}))))),P.a.createElement(u["a"],{span:5},P.a.createElement(H,g()({},A,{label:"\u5b66\u6821"}),I("params[0][schoolId]",{initialValue:h.schoolId})(P.a.createElement(S["a"],{onChange:function(e){return a.schoolChange(e,1)},style:{width:"100%"}},D.line1.map(function(a){return P.a.createElement(x,{key:a.id,value:a.id},a.name)}))))),P.a.createElement(u["a"],{span:3},P.a.createElement(H,{labelCol:{span:7},wrapperCol:{span:17},label:"\u6027\u522b"},I("params[0][gender]",{initialValue:h.gender})(P.a.createElement(S["a"],{onChange:function(e){return a.genderChange(e,1)},style:{width:"100%"}},P.a.createElement(S["a"].Option,{value:"\u7537"},"\u7537"),P.a.createElement(S["a"].Option,{value:"\u5973"},"\u5973")))))),P.a.createElement(d["a"],{gutter:12},P.a.createElement(u["a"],{span:6},P.a.createElement(H,g()({},A,{label:"\u8d5b\u9879"}),I("params[1][categoryId]",{initialValue:f.categoryId})(P.a.createElement(S["a"],{onChange:function(e){return a.categoryChange(e,2,1)},style:{width:"100%"}},E.map(function(a){return P.a.createElement(S["a"].Option,{key:a.id,value:a.id},P.a.createElement(y["a"],{title:a.name},a.name))}))))),P.a.createElement(u["a"],{span:6},P.a.createElement(H,g()({},A,{label:"\u533a\u57df"}),I("params[1][areaId]",{initialValue:f.areaId})(P.a.createElement(m["a"],{allowClear:!1,placeholder:"",onChange:function(e){return a.cascaderChange(e,2)},loadData:function(e){return a.loadCascaderData(e,2)},options:C.line2,style:{width:"100%"}})))),P.a.createElement(u["a"],{span:3},P.a.createElement(H,{labelCol:{span:7},wrapperCol:{span:17},label:"\u7ec4\u522b"},I("params[1][group]",{initialValue:f.group})(P.a.createElement(S["a"],{onChange:function(e){return a.groupChange(e,2)},style:{width:"100%"}},_.line2.map(function(a){return 1===a?P.a.createElement(x,{key:a,value:a},"\u5c0f\u5b66"):2===a?P.a.createElement(x,{key:a,value:a},"\u521d\u4e2d"):3===a?P.a.createElement(x,{key:a,value:a},"\u9ad8\u4e2d"):4===a?P.a.createElement(x,{key:a,value:a},"\u4e2d\u5b66"):void 0}))))),P.a.createElement(u["a"],{span:5},P.a.createElement(H,g()({},A,{label:"\u5b66\u6821"}),I("params[1][schoolId]",{initialValue:f.schoolId})(P.a.createElement(S["a"],{onChange:function(e){return a.schoolChange(e,2)},style:{width:"100%"}},D.line2.map(function(a){return P.a.createElement(x,{key:a.id,value:a.id},a.name)}))))),P.a.createElement(u["a"],{span:3},P.a.createElement(H,{labelCol:{span:7},wrapperCol:{span:17},label:"\u6027\u522b"},I("params[1][gender]",{initialValue:f.gender})(P.a.createElement(S["a"],{onChange:function(e){return a.genderChange(e,2)},style:{width:"100%"}},P.a.createElement(S["a"].Option,{value:"\u7537"},"\u7537"),P.a.createElement(S["a"].Option,{value:"\u5973"},"\u5973")))))),P.a.createElement("div",{style:{marginTop:24,width:600}},P.a.createElement(d["a"],{gutter:16},P.a.createElement(u["a"],{span:7},P.a.createElement(H,{wrapperCol:{span:24}},I("startTime",{rules:[{required:!0,message:"\u5f00\u59cb\u65f6\u95f4\u4e0d\u80fd\u4e3a\u7a7a"}],initialValue:Q()(h.startTime)})(P.a.createElement(p["a"],{disabledDate:this.disabledStartDate,onChange:this.onStartChange,format:"YYYY/MM/DD",placeholder:"\u8bf7\u9009\u62e9\u5f00\u59cb\u65f6\u95f4"})))),P.a.createElement(u["a"],{span:7},P.a.createElement(H,{wrapperCol:{span:24}},I("endTime",{rules:[{required:!0,message:"\u7ed3\u675f\u65f6\u95f4\u4e0d\u80fd\u4e3a\u7a7a"}],initialValue:Q()(h.endTime)})(P.a.createElement(p["a"],{disabledDate:this.disabledEndDate,onChange:this.onEndChange,format:"YYYY/MM/DD",placeholder:"\u8bf7\u9009\u62e9\u7ed3\u675f\u65f6\u95f4"})))),P.a.createElement(u["a"],{span:3},P.a.createElement(c["a"],{loading:Y,onClick:this.handleSubmit,style:{marginTop:3},type:"primary"},"\u7edf\u8ba1")),P.a.createElement(u["a"],{span:3},P.a.createElement(c["a"],{loading:Y,onClick:this.handleReset,style:{marginTop:3},type:"primary"},"\u91cd\u7f6e")),P.a.createElement(u["a"],{span:3},P.a.createElement("a",{href:"/api/stats/sign_up/export?".concat(Object(L["stringify"])(T))},P.a.createElement(c["a"],{loading:Y,style:{marginTop:3}},"\u5bfc\u51fa"))))),P.a.createElement("div",null,P.a.createElement(q["a"],{height:300,data:b,titleMap:{y1:"\u6570\u91cf1",y2:"\u6570\u91cf2"}}))))}}]),e}(F["PureComponent"]),l=i))||l)||l)}}]);