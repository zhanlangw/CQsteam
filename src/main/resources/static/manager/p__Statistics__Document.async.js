(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[65],{ydJx:function(a,e,t){"use strict";t.r(e),t.d(e,"default",function(){return K});t("IzEo");var n,r,l,o,i=t("bx4M"),c=(t("T2oS"),t("W9HT")),s=(t("+L6B"),t("2/Rp")),p=(t("iQDF"),t("+eQT")),d=(t("14J3"),t("BMrR")),m=(t("6UJt"),t("DFOY")),u=(t("jCWc"),t("kPKH")),h=t("jehZ"),y=t.n(h),g=(t("5Dmo"),t("3S7+")),f=t("p0pE"),E=t.n(f),v=t("eHn4"),C=t.n(v),_=t("2Taf"),Y=t.n(_),D=t("vZ4D"),I=t.n(D),b=t("l4Ni"),T=t.n(b),M=t("ujKo"),w=t.n(M),O=t("MhPg"),k=t.n(O),V=(t("y8nQ"),t("Vl3Y")),S=(t("OaEy"),t("2fM7")),F=t("q1tI"),P=t.n(F),j=t("OT3T"),J=t.n(j),R=t("MuoO"),x=t("Qyje"),L=t("wd/R"),N=t.n(L),Q=t("KTCi"),q=S["a"].Option,A={labelCol:{span:4},wrapperCol:{span:18}},H=V["a"].Item,K=(n=V["a"].create(),r=Object(R["connect"])(function(a){var e=a.statistics,t=a.loading;return{statistics:e,loading:t.models.statistics}}),n(l=r((o=function(a){function e(){var a,t;Y()(this,e);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return t=T()(this,(a=w()(e)).call.apply(a,[this].concat(r))),t.state={startValue:null,endValue:null},t.disabledStartDate=function(a){var e=t.state.endValue;return!(!a||!e)&&a.valueOf()>e.valueOf()},t.disabledEndDate=function(a){var e=t.state.startValue;return!(!a||!e)&&a.valueOf()<=e.valueOf()},t.onChange=function(a,e){t.setState(C()({},a,e))},t.onStartChange=function(a){t.onChange("startValue",a)},t.onEndChange=function(a){t.onChange("endValue",a)},t.categoryChange=function(a,e,n){var r=t.props,l=r.dispatch,o=r.form.setFieldsValue,i=r.statistics,c=i.document_areaOption,s=i.document_groupOption,p=i.document_data_params;l({type:"statistics/fetch_category_item",payload:{id:a},params:{type:e,stage:n},callback:function(a){l({type:"statistics/changeAreaOption",payload:E()({},c,C()({},"line".concat(e),a.area.map(function(a){return{value:a.id,label:a.name,isLeaf:!1}}))),params:{type:5}}),l({type:"statistics/changeGroupOption",payload:E()({},s,C()({},"line".concat(e),a.group)),params:{type:5}}),o(C()({},"params[".concat(e-1,"][areaId]"),void 0)),o(C()({},"params[".concat(e-1,"][group]"),void 0)),o(C()({},"params[".concat(e-1,"][schoolId]"),void 0))}}),l({type:"statistics/changeDataParams",payload:E()({},p,C()({},"line".concat(e),E()({},p["line".concat(e)],{categoryId:a}))),params:{type:5}})},t.loadCascaderData=function(a,e){var n=t.props,r=n.dispatch,l=n.statistics.document_areaOption,o=a[a.length-1];o.loading=!0,r({type:"global/fetch_area",payload:{id:o.value},callback:function(a){o.loading=!1,o.children=a.map(function(a){return{label:a.title,value:a.key,isLeaf:a.isLeaf}}),r({type:"statistics/changeAreaOption",payload:E()({},l),params:{type:5}})}})},t.cascaderChange=function(a,e){var n=t.props,r=n.dispatch,l=n.form.setFieldsValue,o=n.statistics.document_data_params;r({type:"statistics/changeDataParams",payload:E()({},o,C()({},"line".concat(e),E()({},o["line".concat(e)],{areaId:a}))),params:{type:5}}),l(C()({},"params[".concat(e-1,"][schoolId]"),void 0)),l(C()({},"params[".concat(e-1,"][group]"),void 0))},t.groupChange=function(a,e){var n=t.props,r=n.dispatch,l=n.form,o=l.setFieldsValue,i=l.getFieldValue,c=n.statistics,s=c.document_schoolOption,p=c.document_data_params,d=i("params[".concat(e-1,"][areaId]"));d=d[d.length-1],r({type:"statistics/fetch_school_list",payload:{areaId:d,start:0,count:1e5,group:a},callback:function(a){r({type:"statistics/changeSchoolOption",payload:E()({},s,C()({},"line".concat(e),a)),params:{type:5}}),o(C()({},"params[".concat(e-1,"][schoolId]"),void 0))}}),r({type:"statistics/changeDataParams",payload:E()({},p,C()({},"line".concat(e),E()({},p["line".concat(e)],{group:a}))),params:{type:5}})},t.schoolChange=function(a,e){var n=t.props,r=n.dispatch,l=n.statistics.document_data_params;r({type:"statistics/changeDataParams",payload:E()({},l,C()({},"line".concat(e),E()({},l["line".concat(e)],{schoolId:a}))),params:{type:5}})},t.handleSubmit=function(){var a=t.props,e=a.dispatch,n=a.form.validateFields,r=a.statistics.document_data_params,l=r.line1,o=r.line2;n(function(a,t){a||(e({type:"statistics/fetch_document_data",payload:E()({},l,{startTime:N()(t.startTime).format("YYYY/MM/DD"),endTime:N()(t.endTime).format("YYYY/MM/DD")}),params:{type:1}}),e({type:"statistics/fetch_document_data",payload:E()({},o,{startTime:N()(t.startTime).format("YYYY/MM/DD"),endTime:N()(t.endTime).format("YYYY/MM/DD")}),params:{type:2}}))})},t.handleReset=function(){var a=t.props,e=a.dispatch,n=a.form.resetFields;n(),e({type:"statistics/fetch_document_data",payload:{startTime:N()().subtract(7,"days").format("YYYY/MM/DD"),endTime:N()().format("YYYY/MM/DD")},params:{type:1}}),e({type:"statistics/fetch_document_data",payload:{startTime:N()().subtract(7,"days").format("YYYY/MM/DD"),endTime:N()().format("YYYY/MM/DD")},params:{type:2}})},t}return k()(e,a),I()(e,[{key:"componentDidMount",value:function(){var a=this.props,e=a.dispatch,t=a.statistics.document_data_params,n=t.line1,r=t.line2;e({type:"statistics/fetch_category_list",payload:{start:0,count:1e4}}),e({type:"statistics/fetch_document_data",payload:E()({},n),params:{type:1}}),e({type:"statistics/fetch_document_data",payload:E()({},r),params:{type:2}})}},{key:"render",value:function(){var a=this,e=this.props,t=e.statistics,n=t.document_data,r=n.line1,l=n.line2,o=t.document_data_params,h=o.line1,f=o.line2,E=t.category_list,v=t.document_category_item,C=(v.line1,v.line2,t.document_areaOption),_=t.document_groupOption,Y=t.document_schoolOption,D=e.loading,I=e.form.getFieldDecorator,b=r.data.map(function(a,e){return{x:a.createTime,y1:a.count,y2:l.data[e]&&l.data[e].count||0}}),T={startTime:h.startTime,endTime:h.endTime,categoryId1:h.categoryId,areaId1:h.areaId&&h.areaId[h.areaId.length-1],group1:h.group,schoolId1:h.schoolId,categoryId2:f.categoryId,areaId2:f.areaId&&f.areaId[f.areaId.length-1],group2:f.group,schoolId2:f.schoolId};for(var M in T){var w=T[M];w||delete T[M]}return P.a.createElement(i["a"],{bordered:!1},P.a.createElement(c["a"],{spinning:D},P.a.createElement("div",null,P.a.createElement("span",{className:J.a.total},P.a.createElement("p",{className:J.a.total_title},"\u622a\u6b62\u5f53\u524d\u603b\u91cf"),P.a.createElement("div",{className:J.a.total_num},r.totalCount))),P.a.createElement(d["a"],{gutter:12,style:{marginTop:48}},P.a.createElement(u["a"],{span:6},P.a.createElement(H,y()({},A,{label:"\u8d5b\u9879"}),I("params[0][categoryId]",{initialValue:h.categoryId})(P.a.createElement(S["a"],{onChange:function(e){return a.categoryChange(e,1,5)},style:{width:"100%"}},E.map(function(a){return P.a.createElement(S["a"].Option,{key:a.id,value:a.id},P.a.createElement(g["a"],{title:a.name},a.name))}))))),P.a.createElement(u["a"],{span:6},P.a.createElement(H,y()({},A,{label:"\u533a\u57df"}),I("params[0][areaId]",{initialValue:h.areaId})(P.a.createElement(m["a"],{allowClear:!1,placeholder:"",onChange:function(e){return a.cascaderChange(e,1)},loadData:function(e){return a.loadCascaderData(e,1)},options:C.line1,style:{width:"100%"}})))),P.a.createElement(u["a"],{span:3},P.a.createElement(H,{labelCol:{span:7},wrapperCol:{span:17},label:"\u7ec4\u522b"},I("params[0][group]",{initialValue:h.group})(P.a.createElement(S["a"],{onChange:function(e){return a.groupChange(e,1)},style:{width:"100%"}},_.line1.map(function(a){return 1===a?P.a.createElement(q,{key:a,value:a},"\u5c0f\u5b66"):2===a?P.a.createElement(q,{key:a,value:a},"\u521d\u4e2d"):3===a?P.a.createElement(q,{key:a,value:a},"\u9ad8\u4e2d"):4===a?P.a.createElement(q,{key:a,value:a},"\u4e2d\u5b66"):void 0}))))),P.a.createElement(u["a"],{span:5},P.a.createElement(H,y()({},A,{label:"\u5b66\u6821"}),I("params[0][schoolId]",{initialValue:h.schoolId})(P.a.createElement(S["a"],{onChange:function(e){return a.schoolChange(e,1)},style:{width:"100%"}},Y.line1.map(function(a){return P.a.createElement(q,{key:a.id,value:a.id},a.name)})))))),P.a.createElement(d["a"],{gutter:12},P.a.createElement(u["a"],{span:6},P.a.createElement(H,y()({},A,{label:"\u8d5b\u9879"}),I("params[1][categoryId]",{initialValue:f.categoryId})(P.a.createElement(S["a"],{onChange:function(e){return a.categoryChange(e,2,5)},style:{width:"100%"}},E.map(function(a){return P.a.createElement(S["a"].Option,{key:a.id,value:a.id},P.a.createElement(g["a"],{title:a.name},a.name))}))))),P.a.createElement(u["a"],{span:6},P.a.createElement(H,y()({},A,{label:"\u533a\u57df"}),I("params[1][areaId]",{initialValue:f.areaId})(P.a.createElement(m["a"],{allowClear:!1,placeholder:"",onChange:function(e){return a.cascaderChange(e,2)},loadData:function(e){return a.loadCascaderData(e,2)},options:C.line2,style:{width:"100%"}})))),P.a.createElement(u["a"],{span:3},P.a.createElement(H,{labelCol:{span:7},wrapperCol:{span:17},label:"\u7ec4\u522b"},I("params[1][group]",{initialValue:f.group})(P.a.createElement(S["a"],{onChange:function(e){return a.groupChange(e,2)},style:{width:"100%"}},_.line2.map(function(a){return 1===a?P.a.createElement(q,{key:a,value:a},"\u5c0f\u5b66"):2===a?P.a.createElement(q,{key:a,value:a},"\u521d\u4e2d"):3===a?P.a.createElement(q,{key:a,value:a},"\u9ad8\u4e2d"):4===a?P.a.createElement(q,{key:a,value:a},"\u4e2d\u5b66"):void 0}))))),P.a.createElement(u["a"],{span:5},P.a.createElement(H,y()({},A,{label:"\u5b66\u6821"}),I("params[1][schoolId]",{initialValue:f.schoolId})(P.a.createElement(S["a"],{onChange:function(e){return a.schoolChange(e,2)},style:{width:"100%"}},Y.line2.map(function(a){return P.a.createElement(q,{key:a.id,value:a.id},a.name)})))))),P.a.createElement("div",{style:{marginTop:24,width:600}},P.a.createElement(d["a"],{gutter:16},P.a.createElement(u["a"],{span:7},P.a.createElement(H,{wrapperCol:{span:24}},I("startTime",{rules:[{required:!0,message:"\u5f00\u59cb\u65f6\u95f4\u4e0d\u80fd\u4e3a\u7a7a"}],initialValue:N()(h.startTime)})(P.a.createElement(p["a"],{disabledDate:this.disabledStartDate,onChange:this.onStartChange,format:"YYYY/MM/DD",placeholder:"\u8bf7\u9009\u62e9\u5f00\u59cb\u65f6\u95f4"})))),P.a.createElement(u["a"],{span:7},P.a.createElement(H,{wrapperCol:{span:24}},I("endTime",{rules:[{required:!0,message:"\u7ed3\u675f\u65f6\u95f4\u4e0d\u80fd\u4e3a\u7a7a"}],initialValue:N()(h.endTime)})(P.a.createElement(p["a"],{disabledDate:this.disabledEndDate,onChange:this.onEndChange,format:"YYYY/MM/DD",placeholder:"\u8bf7\u9009\u62e9\u7ed3\u675f\u65f6\u95f4"})))),P.a.createElement(u["a"],{span:3},P.a.createElement(s["a"],{loading:D,onClick:this.handleSubmit,style:{marginTop:3},type:"primary"},"\u7edf\u8ba1")),P.a.createElement(u["a"],{span:3},P.a.createElement(s["a"],{loading:D,onClick:this.handleReset,style:{marginTop:3},type:"primary"},"\u91cd\u7f6e")),P.a.createElement(u["a"],{span:3},P.a.createElement("a",{href:"/api/stats/submit/export?".concat(Object(x["stringify"])(T))},P.a.createElement(s["a"],{loading:D,style:{marginTop:3}},"\u5bfc\u51fa"))))),P.a.createElement("div",null,P.a.createElement(Q["a"],{height:300,data:b,titleMap:{y1:"\u6570\u91cf1",y2:"\u6570\u91cf2"}}))))}}]),e}(F["PureComponent"]),l=o))||l)||l)}}]);